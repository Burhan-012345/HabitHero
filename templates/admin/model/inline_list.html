{% extends 'admin/layout.html' %} {% import 'admin/lib.html' as lib with context
%} {% block title %}Inline List - {{ admin_view.name }}{% endblock %} {% block
breadcrumb %}
<li class="breadcrumb-item">
  <a href="{{ url_for('admin.index') }}">Admin</a>
</li>
<li class="breadcrumb-item">
  <a href="{{ url_for('.index_view') }}">{{ admin_view.name }}</a>
</li>
<li class="breadcrumb-item active">Inline List</li>
{% endblock %} {% block body %}
<div class="container-fluid">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="h3 mb-0">Inline List - {{ admin_view.name }}</h1>
    <div class="btn-group">
      <a href="{{ url_for('.create_view') }}" class="btn btn-admin">
        <i class="fas fa-plus"></i> Add New
      </a>
      <a href="{{ url_for('.index_view') }}" class="btn btn-outline-secondary">
        <i class="fas fa-arrow-left"></i> Back to List
      </a>
    </div>
  </div>

  <div class="card shadow">
    <div class="card-body">
      {% block inline_list_table %}
      <div class="table-responsive">
        <table class="table table-hover table-sm">
          <thead>
            <tr>
              {% for column in admin_view.list_columns %}
              <th>{{ admin_view.get_column_name(column) }}</th>
              {% endfor %}
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for row in data %}
            <tr>
              {% for column in admin_view.list_columns %}
              <td>
                {% set value = get_value(row, column) %} {% if value is string
                %} {{ value|truncate(50) }} {% else %} {{ value }} {% endif %}
              </td>
              {% endfor %}
              <td>
                <div class="btn-group btn-group-xs">
                  {% if admin_view.can_edit %}
                  <a
                    href="{{ url_for('.edit_view', id=get_pk_value(row), url=return_url) }}"
                    class="btn btn-outline-primary btn-sm"
                    title="Edit"
                  >
                    <i class="fas fa-edit fa-xs"></i>
                  </a>
                  {% endif %} {% if admin_view.can_delete %}
                  <a
                    href="{{ url_for('.delete_view', id=get_pk_value(row), url=return_url) }}"
                    class="btn btn-outline-danger btn-sm confirm-delete"
                    title="Delete"
                  >
                    <i class="fas fa-trash fa-xs"></i>
                  </a>
                  {% endif %}
                </div>
              </td>
            </tr>
            {% else %}
            <tr>
              <td
                colspan="{{ admin_view.list_columns|length + 1 }}"
                class="text-center text-muted py-3"
              >
                <i class="fas fa-inbox fa-lg mb-2"></i>
                <p class="mb-0">No inline records found</p>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% endblock %}

      <!-- Pagination for inline list -->
      {% if pagination %}
      <div class="mt-3">
        <nav aria-label="Inline list pagination">
          <ul class="pagination pagination-sm justify-content-center">
            {% if pagination.has_prev %}
            <li class="page-item">
              <a
                class="page-link"
                href="{{ url_for('.inline_list', page=pagination.prev_num) }}"
              >
                <i class="fas fa-chevron-left"></i>
              </a>
            </li>
            {% endif %} {% for page in pagination.iter_pages(left_edge=1,
            right_edge=1, left_current=2, right_current=2) %} {% if page %} {%
            if page == pagination.page %}
            <li class="page-item active">
              <span class="page-link">{{ page }}</span>
            </li>
            {% else %}
            <li class="page-item">
              <a
                class="page-link"
                href="{{ url_for('.inline_list', page=page) }}"
                >{{ page }}</a
              >
            </li>
            {% endif %} {% else %}
            <li class="page-item disabled">
              <span class="page-link">...</span>
            </li>
            {% endif %} {% endfor %} {% if pagination.has_next %}
            <li class="page-item">
              <a
                class="page-link"
                href="{{ url_for('.inline_list', page=pagination.next_num) }}"
              >
                <i class="fas fa-chevron-right"></i>
              </a>
            </li>
            {% endif %}
          </ul>
        </nav>

        <div class="text-center text-muted small">
          Showing {{ pagination.first }} - {{ pagination.last }} of {{
          pagination.total }} records
        </div>
      </div>
      {% endif %}
    </div>
  </div>

  <!-- Quick Add Form (if applicable) -->
  {% if admin_view.can_create %}
  <div class="card shadow mt-4">
    <div class="card-header">
      <h6 class="m-0 font-weight-bold text-primary">Quick Add</h6>
    </div>
    <div class="card-body">
      {% block quick_add_form %}
      <form
        method="POST"
        action="{{ url_for('.inline_create') }}"
        class="form-inline"
      >
        {{ form.hidden_tag() if form.hidden_tag }} {% for field in form if
        field.type != 'CSRFTokenField' %}
        <div class="form-group mr-3 mb-2">
          {{ field.label(class="sr-only") }} {{ field(class="form-control
          form-control-sm", placeholder=field.label.text) }} {% if field.errors
          %}
          <div class="invalid-feedback d-block">
            {% for error in field.errors %} {{ error }} {% endfor %}
          </div>
          {% endif %}
        </div>
        {% endfor %}

        <button type="submit" class="btn btn-admin btn-sm mb-2">
          <i class="fas fa-plus"></i> Add
        </button>
      </form>
      {% endblock %}
    </div>
  </div>
  {% endif %}

  <!-- Bulk Actions -->
  {% if admin_view.can_delete %}
  <div class="card shadow mt-4">
    <div class="card-header">
      <h6 class="m-0 font-weight-bold text-primary">Bulk Actions</h6>
    </div>
    <div class="card-body">
      <form method="POST" action="{{ url_for('.bulk_delete') }}" id="bulkForm">
        <div class="form-group">
          <label for="bulkAction">Select Action:</label>
          <select
            class="form-control form-control-sm"
            id="bulkAction"
            name="action"
            style="max-width: 200px"
          >
            <option value="">-- Select --</option>
            <option value="delete">Delete Selected</option>
            <option value="activate">Activate Selected</option>
            <option value="deactivate">Deactivate Selected</option>
          </select>
        </div>

        <button
          type="button"
          class="btn btn-outline-danger btn-sm"
          onclick="confirmBulkAction()"
        >
          <i class="fas fa-play"></i> Execute Bulk Action
        </button>
      </form>
    </div>
  </div>
  {% endif %}
</div>

<script>
  function confirmBulkAction() {
    const action = document.getElementById("bulkAction").value;
    if (!action) {
      alert("Please select an action first.");
      return;
    }

    if (confirm(`Are you sure you want to ${action} the selected items?`)) {
      document.getElementById("bulkForm").submit();
    }
  }

  // Select all checkbox functionality
  function toggleSelectAll(source) {
    const checkboxes = document.querySelectorAll(".item-checkbox");
    checkboxes.forEach((checkbox) => {
      checkbox.checked = source.checked;
    });
  }
</script>

<style>
  .inline-list-actions {
    white-space: nowrap;
  }

  .table-sm td,
  .table-sm th {
    padding: 0.5rem;
  }

  .form-inline .form-group {
    margin-right: 0.5rem;
  }

  .btn-group-xs > .btn,
  .btn-xs {
    padding: 0.25rem 0.5rem;
    font-size: 0.75rem;
    line-height: 1.5;
    border-radius: 0.2rem;
  }
</style>
{% endblock %}
